this function from master branch
this update is from feature2 branch
